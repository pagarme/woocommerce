(()=>{var e={694:(e,t,n)=>{"use strict";var r=n(925);function a(){}function s(){}s.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,s,o){if(o!==r){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:a};return n.PropTypes=n,n}},556:(e,t,n)=>{e.exports=n(694)()},925:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},844:(e,t,n)=>{e.exports=n(200)},200:(e,t,n)=>{"use strict";var r,a=(r=n(609))&&"object"==typeof r&&"default"in r?r.default:r,s=n(795);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var i=function(e,t,n,r,a,s,o,l){if(!e){var i;if(void 0===t)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,a,s,o,l],c=0;(i=new Error(t.replace(/%s/g,(function(){return u[c++]})))).name="Invariant Violation"}throw i.framesToPop=1,i}};function u(e,t,n){if("selectionStart"in e&&"selectionEnd"in e)e.selectionStart=t,e.selectionEnd=n;else{var r=e.createTextRange();r.collapse(!0),r.moveStart("character",t),r.moveEnd("character",n-t),r.select()}}var c={9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"};function d(e,t,n){var r="",a="",s=null,o=[];if(void 0===t&&(t="_"),null==n&&(n=c),!e||"string"!=typeof e)return{maskChar:t,formatChars:n,mask:null,prefix:null,lastEditablePosition:null,permanents:[]};var l=!1;return e.split("").forEach((function(e){l=!l&&"\\"===e||(l||!n[e]?(o.push(r.length),r.length===o.length-1&&(a+=e)):s=r.length+1,r+=e,!1)})),{maskChar:t,formatChars:n,prefix:a,mask:r,lastEditablePosition:s,permanents:o}}function p(e,t){return-1!==e.permanents.indexOf(t)}function m(e,t,n){var r=e.mask,a=e.formatChars;if(!n)return!1;if(p(e,t))return r[t]===n;var s=a[r[t]];return new RegExp(s).test(n)}function v(e,t){return t.split("").every((function(t,n){return p(e,n)||!m(e,n,t)}))}function f(e,t){var n=e.maskChar,r=e.prefix;if(!n){for(;t.length>r.length&&p(e,t.length-1);)t=t.slice(0,t.length-1);return t.length}for(var a=r.length,s=t.length;s>=r.length;s--){var o=t[s];if(!p(e,s)&&m(e,s,o)){a=s+1;break}}return a}function h(e,t){return f(e,t)===e.mask.length}function g(e,t){var n=e.maskChar,r=e.mask,a=e.prefix;if(!n){for((t=b(e,"",t,0)).length<a.length&&(t=a);t.length<r.length&&p(e,t.length);)t+=r[t.length];return t}if(t)return b(e,g(e,""),t,0);for(var s=0;s<r.length;s++)p(e,s)?t+=r[s]:t+=n;return t}function b(e,t,n,r){var a=e.mask,s=e.maskChar,o=e.prefix,l=n.split(""),i=h(e,t);return!s&&r>t.length&&(t+=a.slice(t.length,r)),l.every((function(n){for(;c=n,p(e,u=r)&&c!==a[u];){if(r>=t.length&&(t+=a[r]),l=n,s&&p(e,r)&&l===s)return!0;if(++r>=a.length)return!1}var l,u,c;return!m(e,r,n)&&n!==s||(r<t.length?t=s||i||r<o.length?t.slice(0,r)+n+t.slice(r+1):(t=t.slice(0,r)+n+t.slice(r),g(e,t)):s||(t+=n),++r<a.length)})),t}function E(e,t){for(var n=e.mask,r=t;r<n.length;++r)if(!p(e,r))return r;return null}function C(e){return e||0===e?e+"":""}function I(e){return"function"==typeof e}function k(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame}function w(e){return(k()?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame:function(){return setTimeout(e,1e3/60)})(e)}function y(e){(k()||clearTimeout)(e)}var R=function(e){function t(t){var n=e.call(this,t)||this;n.focused=!1,n.mounted=!1,n.previousSelection=null,n.selectionDeferId=null,n.saveSelectionLoopDeferId=null,n.saveSelectionLoop=function(){n.previousSelection=n.getSelection(),n.saveSelectionLoopDeferId=w(n.saveSelectionLoop)},n.runSaveSelectionLoop=function(){null===n.saveSelectionLoopDeferId&&n.saveSelectionLoop()},n.stopSaveSelectionLoop=function(){null!==n.saveSelectionLoopDeferId&&(y(n.saveSelectionLoopDeferId),n.saveSelectionLoopDeferId=null,n.previousSelection=null)},n.getInputDOMNode=function(){if(!n.mounted)return null;var e=s.findDOMNode(l(l(n))),t="undefined"!=typeof window&&e instanceof window.Element;if(e&&!t)return null;if("INPUT"!==e.nodeName&&(e=e.querySelector("input")),!e)throw new Error("react-input-mask: inputComponent doesn't contain input node");return e},n.getInputValue=function(){var e=n.getInputDOMNode();return e?e.value:null},n.setInputValue=function(e){var t=n.getInputDOMNode();t&&(n.value=e,t.value=e)},n.setCursorToEnd=function(){var e=f(n.maskOptions,n.value),t=E(n.maskOptions,e);null!==t&&n.setCursorPosition(t)},n.setSelection=function(e,t,r){void 0===r&&(r={});var a=n.getInputDOMNode(),s=n.isFocused();a&&s&&(r.deferred||u(a,e,t),null!==n.selectionDeferId&&y(n.selectionDeferId),n.selectionDeferId=w((function(){n.selectionDeferId=null,u(a,e,t)})),n.previousSelection={start:e,end:t,length:Math.abs(t-e)})},n.getSelection=function(){return function(e){var t=0,n=0;if("selectionStart"in e&&"selectionEnd"in e)t=e.selectionStart,n=e.selectionEnd;else{var r=document.selection.createRange();r.parentElement()===e&&(t=-r.moveStart("character",-e.value.length),n=-r.moveEnd("character",-e.value.length))}return{start:t,end:n,length:n-t}}(n.getInputDOMNode())},n.getCursorPosition=function(){return n.getSelection().start},n.setCursorPosition=function(e){n.setSelection(e,e)},n.isFocused=function(){return n.focused},n.getBeforeMaskedValueChangeConfig=function(){var e=n.maskOptions,t=e.mask,r=e.maskChar,a=e.permanents,s=e.formatChars;return{mask:t,maskChar:r,permanents:a,alwaysShowMask:!!n.props.alwaysShowMask,formatChars:s}},n.isInputAutofilled=function(e,t,r,a){var s=n.getInputDOMNode();try{if(s.matches(":-webkit-autofill"))return!0}catch(e){}return!n.focused||a.end<r.length&&t.end===e.length},n.onChange=function(e){var t=l(l(n)).beforePasteState,r=l(l(n)).previousSelection,a=n.props.beforeMaskedValueChange,s=n.getInputValue(),o=n.value,i=n.getSelection();n.isInputAutofilled(s,i,o,r)&&(o=g(n.maskOptions,""),r={start:0,end:0,length:0}),t&&(r=t.selection,o=t.value,i={start:r.start+s.length,end:r.start+s.length,length:0},s=o.slice(0,r.start)+s+o.slice(r.end),n.beforePasteState=null);var u=function(e,t,n,r,a){var s=e.mask,o=e.prefix,l=e.lastEditablePosition,i=t,u="",c=0,d=0,v=Math.min(a.start,n.start);return n.end>a.start?d=(c=function(e,t,n,r){var a=e.mask,s=e.maskChar,o=n.split(""),l=r;return o.every((function(t){for(;o=t,p(e,n=r)&&o!==a[n];)if(++r>=a.length)return!1;var n,o;return(m(e,r,t)||t===s)&&r++,r<a.length})),r-l}(e,0,u=i.slice(a.start,n.end),v))?a.length:0:i.length<r.length&&(d=r.length-i.length),i=r,d&&(1!==d||a.length||(v=a.start===n.start?E(e,n.start):function(e,t){for(var n=t;0<=n;--n)if(!p(e,n))return n;return null}(e,n.start)),i=function(e,t,n,r){var a=n+r,s=e.maskChar,o=e.mask,l=e.prefix,i=t.split("");if(s)return i.map((function(t,r){return r<n||a<=r?t:p(e,r)?o[r]:s})).join("");for(var u=a;u<i.length;u++)p(e,u)&&(i[u]="");return n=Math.max(l.length,n),i.splice(n,a-n),t=i.join(""),g(e,t)}(e,i,v,d)),i=b(e,i,u,v),(v+=c)>=s.length?v=s.length:v<o.length&&!c?v=o.length:v>=o.length&&v<l&&c&&(v=E(e,v)),u||(u=null),{value:i=g(e,i),enteredString:u,selection:{start:v,end:v}}}(n.maskOptions,s,i,o,r),c=u.enteredString,d=u.selection,v=u.value;if(I(a)){var f=a({value:v,selection:d},{value:o,selection:r},c,n.getBeforeMaskedValueChangeConfig());v=f.value,d=f.selection}n.setInputValue(v),I(n.props.onChange)&&n.props.onChange(e),n.isWindowsPhoneBrowser?n.setSelection(d.start,d.end,{deferred:!0}):n.setSelection(d.start,d.end)},n.onFocus=function(e){var t=n.props.beforeMaskedValueChange,r=n.maskOptions,a=r.mask,s=r.prefix;if(n.focused=!0,n.mounted=!0,a){if(n.value)f(n.maskOptions,n.value)<n.maskOptions.mask.length&&n.setCursorToEnd();else{var o=g(n.maskOptions,s),l=g(n.maskOptions,o),i=f(n.maskOptions,l),u=E(n.maskOptions,i),c={start:u,end:u};if(I(t)){var d=t({value:l,selection:c},{value:n.value,selection:null},null,n.getBeforeMaskedValueChangeConfig());l=d.value,c=d.selection}var p=l!==n.getInputValue();p&&n.setInputValue(l),p&&I(n.props.onChange)&&n.props.onChange(e),n.setSelection(c.start,c.end)}n.runSaveSelectionLoop()}I(n.props.onFocus)&&n.props.onFocus(e)},n.onBlur=function(e){var t=n.props.beforeMaskedValueChange,r=n.maskOptions.mask;if(n.stopSaveSelectionLoop(),n.focused=!1,r&&!n.props.alwaysShowMask&&v(n.maskOptions,n.value)){var a="";I(t)&&(a=t({value:a,selection:null},{value:n.value,selection:n.previousSelection},null,n.getBeforeMaskedValueChangeConfig()).value);var s=a!==n.getInputValue();s&&n.setInputValue(a),s&&I(n.props.onChange)&&n.props.onChange(e)}I(n.props.onBlur)&&n.props.onBlur(e)},n.onMouseDown=function(e){!n.focused&&document.addEventListener&&(n.mouseDownX=e.clientX,n.mouseDownY=e.clientY,n.mouseDownTime=(new Date).getTime(),document.addEventListener("mouseup",(function e(t){if(document.removeEventListener("mouseup",e),n.focused){var r=Math.abs(t.clientX-n.mouseDownX),a=Math.abs(t.clientY-n.mouseDownY),s=Math.max(r,a),o=(new Date).getTime()-n.mouseDownTime;(s<=10&&o<=200||s<=5&&o<=300)&&n.setCursorToEnd()}}))),I(n.props.onMouseDown)&&n.props.onMouseDown(e)},n.onPaste=function(e){I(n.props.onPaste)&&n.props.onPaste(e),e.defaultPrevented||(n.beforePasteState={value:n.getInputValue(),selection:n.getSelection()},n.setInputValue(""))},n.handleRef=function(e){null==n.props.children&&I(n.props.inputRef)&&n.props.inputRef(e)};var r=t.mask,a=t.maskChar,o=t.formatChars,i=t.alwaysShowMask,c=t.beforeMaskedValueChange,h=t.defaultValue,k=t.value;n.maskOptions=d(r,a,o),null==h&&(h=""),null==k&&(k=h);var R=C(k);if(n.maskOptions.mask&&(i||R)&&(R=g(n.maskOptions,R),I(c))){var x=t.value;null==t.value&&(x=h),R=c({value:R,selection:null},{value:x=C(x),selection:null},null,n.getBeforeMaskedValueChangeConfig()).value}return n.value=R,n}!function(e,t){e.prototype=Object.create(t.prototype),function(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var a=n[r],s=Object.getOwnPropertyDescriptor(t,a);s&&s.configurable&&void 0===e[a]&&Object.defineProperty(e,a,s)}}(e.prototype.constructor=e,t)}(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.getInputDOMNode()&&(this.isWindowsPhoneBrowser=function(){var e=new RegExp("windows","i"),t=new RegExp("phone","i"),n=navigator.userAgent;return e.test(n)&&t.test(n)}(),this.maskOptions.mask&&this.getInputValue()!==this.value&&this.setInputValue(this.value))},n.componentDidUpdate=function(){var e=this.previousSelection,t=this.props,n=t.beforeMaskedValueChange,r=t.alwaysShowMask,a=t.mask,s=t.maskChar,o=t.formatChars,l=this.maskOptions,i=r||this.isFocused(),u=null!=this.props.value,c=u?C(this.props.value):this.value,p=e?e.start:null;if(this.maskOptions=d(a,s,o),this.maskOptions.mask){!l.mask&&this.isFocused()&&this.runSaveSelectionLoop();var m=this.maskOptions.mask&&this.maskOptions.mask!==l.mask;if(l.mask||u||(c=this.getInputValue()),(m||this.maskOptions.mask&&(c||i))&&(c=g(this.maskOptions,c)),m){var b=f(this.maskOptions,c);(null===p||b<p)&&(p=h(this.maskOptions,c)?b:E(this.maskOptions,b))}!this.maskOptions.mask||!v(this.maskOptions,c)||i||u&&this.props.value||(c="");var k={start:p,end:p};if(I(n)){var w=n({value:c,selection:k},{value:this.value,selection:this.previousSelection},null,this.getBeforeMaskedValueChangeConfig());c=w.value,k=w.selection}this.value=c;var y=this.getInputValue()!==this.value;y?(this.setInputValue(this.value),this.forceUpdate()):m&&this.forceUpdate();var R=!1;null!=k.start&&null!=k.end&&(R=!e||e.start!==k.start||e.end!==k.end),(R||y)&&this.setSelection(k.start,k.end)}else l.mask&&(this.stopSaveSelectionLoop(),this.forceUpdate())},n.componentWillUnmount=function(){this.mounted=!1,null!==this.selectionDeferId&&y(this.selectionDeferId),this.stopSaveSelectionLoop()},n.render=function(){var e,t=this.props,n=(t.mask,t.alwaysShowMask,t.maskChar,t.formatChars,t.inputRef,t.beforeMaskedValueChange,t.children),r=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],0<=t.indexOf(n)||(a[n]=e[n]);return a}(t,["mask","alwaysShowMask","maskChar","formatChars","inputRef","beforeMaskedValueChange","children"]);if(n){I(n)||i(!1);var s=["onChange","onPaste","onMouseDown","onFocus","onBlur","value","disabled","readOnly"],l=o({},r);s.forEach((function(e){return delete l[e]})),e=n(l),s.filter((function(t){return null!=e.props[t]&&e.props[t]!==r[t]})).length&&i(!1)}else e=a.createElement("input",o({ref:this.handleRef},r));var u={onFocus:this.onFocus,onBlur:this.onBlur};return this.maskOptions.mask&&(r.disabled||r.readOnly||(u.onChange=this.onChange,u.onPaste=this.onPaste,u.onMouseDown=this.onMouseDown),null!=r.value&&(u.value=this.value)),e=a.cloneElement(e,u)},t}(a.Component);e.exports=R},609:e=>{"use strict";e.exports=window.React},795:e=>{"use strict";e.exports=window.ReactDOM}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(609),t=n(556),r=n.n(t);const a=window.wp.element,{formatPrice:s}=window.wc.priceFormat,o=({optionLabel:e,finalPrice:t,value:n,extraText:r,installmentPrice:a})=>{const o=s(a),l=s(t);return 1===n?`${e} (${o})`:`${n}x ${e} ${o} (${l}) ${r}`.trim()},l=e=>e.map((e=>({label:o(e),value:e.value}))),i=(e,t,n,r,s,o,i)=>{const[u,c]=(0,a.useState)(l(e)),d=(e=>{const t=(0,a.useRef)();return(0,a.useEffect)((()=>{t.current=e})),t.current})(r);return(0,a.useEffect)((()=>{(async()=>{if(2===t&&!n||1===t&&(!d||d===r))return;o(!0);const e=parseFloat(r/100).toFixed(2).replace(".",",");try{const t=await fetch("/wp-admin/admin-ajax.php?"+new URLSearchParams({action:"xqRhBHJ5sW",flag:n,total:e}),{headers:{"X-Request-Type":"Ajax"}});if(!t.ok)return void o(!1);const r=await t.json();if(!r?.installments?.length)return void o(!1);c(l(r.installments)),s(i,1),o(!1)}catch(e){return void o(!1)}})()}),[n,r,t,c,l,s,i]),(0,a.useEffect)((()=>{2===t&&c([{label:"...",value:""}])}),[t,c]),{installmentsOptions:u,filterHandler:e=>{u.filter((t=>t.label.toLowerCase().startsWith(e.toLowerCase())))},installmentsChangeHandler:e=>{s(i,e)}}},{ComboboxControl:u}=wp.components,c=({label:t,installments:n,installmentsType:r,selectedInstallment:a,setSelectedInstallment:s,brand:o,cartTotal:l,setIsLoading:c,cardIndex:d})=>{const{installmentsOptions:p,filterHandler:m,installmentsChangeHandler:v}=i(n,r,o,l,s,c,d);return(0,e.createElement)("div",{className:"wc-block-components-select-input pagarme-installments-combobox"},(0,e.createElement)("div",{className:"wc-block-components-combobox is-active"},(0,e.createElement)(u,{className:"wc-block-components-combobox-control",label:t,onChange:v,value:a,options:p,onFilterValueChange:m,allowReset:!1,autoComplete:"off"})))};c.propTypes={label:r().string.isRequired,installments:r().array.isRequired,installmentsType:r().number.isRequired,selectedInstallment:r().oneOfType([r().string,r().number]).isRequired,setSelectedInstallment:r().func.isRequired,brand:r().string.isRequired,cartTotal:r().number.isRequired,setIsLoading:r().func.isRequired,cardIndex:r().number.isRequired};const d=c;function p(e){return e.replace(/\s/g,"").split("/")}const m=(e,t,n,r)=>{const a=(e,t)=>(delete t.inputHolderName,e.length>0||(t.inputHolderName=r.holderName),t),s=(e,t)=>(delete t.inputNumber,16===(e=e.replace(/(\D)/g,"")).length||(t.inputNumber=r.cardNumber),t),o=(e,t)=>{if(delete t.inputExpiry,0===e.length)return t.inputExpiry=r.emptyExpiry,t;const[n,a]=p(e),s=new Date(`20${a}`,n-1);let o=new Date;return o=new Date(o.getFullYear(),o.getMonth()),n>=1&&n<=12||(t.inputExpiry=r.invalidExpiryMonth),!a.includes("_")||(t.inputExpiry=r.invalidExpiryYear),s<o&&(t.inputExpiry=r.expiredCard),t},l=(e,t)=>(delete t.inputCvv,0===(e=e.replace(/(\D)/g,"")).length?(t.inputCvv=r.emptyCvv,t):(3===e.length||4===e.length||(t.inputCvv=r.invalidCvv),t));return{validateInputHolderName:r=>{const s=a(r,t);return n(e,{...s}),!!s.inputHolderName},validateInputNumber:r=>{const a=s(r,t);return n(e,{...a}),!!a.inputNumber},validateInputExpiry:r=>{const a=o(r,t);return n(e,{...a}),!!a.inputExpiry},validateInputCvv:r=>{const a=l(r,t);return n(e,{...a}),!!a.inputCvv},validateAllFields:(r,i,u,c)=>{let d={...t};return d=a(r,d),d=s(i,d),d=o(u,d),d=l(c,d),n(e,{...d}),0===Object.keys(d).length}}},v=({id:t,label:n,inputValue:r,setInputValue:s,cardIndex:o,errors:l,setErrors:i,fieldErrors:u})=>{const{setIsActive:c,cssClasses:d,inputChangeHandler:p,inputBlurHandler:v}=((e,t,n,r,s,o)=>{const{validateInputHolderName:l}=m(n,r,s,o);let i="wc-block-components-text-input";const[u,c]=(0,a.useState)(!1);return(u||e.length)&&(i+=" is-active"),r.hasOwnProperty("inputHolderName")&&(i+=" has-error"),{setIsActive:c,cssClasses:i,inputChangeHandler:e=>{const r=e.target.value.replace(/[^a-z ]/gi,"");t(n,r)},inputBlurHandler:e=>{l(e.target.value),c(!1)}}})(r,s,o,l,i,u);return(0,e.createElement)("div",{className:d},(0,e.createElement)("label",{htmlFor:t},n),(0,e.createElement)("input",{type:"text",id:t,value:r,onChange:p,onFocus:()=>c(!0),onBlur:v}),l.inputHolderName&&(0,e.createElement)("div",{className:"wc-block-components-validation-error",role:"alert"},(0,e.createElement)("p",null,l.inputHolderName)))};v.propTypes={id:r().string.isRequired,label:r().string.isRequired,inputValue:r().string.isRequired,setInputValue:r().func.isRequired,cardIndex:r().number.isRequired,errors:r().object.isRequired,setErrors:r().func.isRequired,fieldErrors:r().object.isRequired};const f=v;var h=n(844),g=n.n(h);function b(e){return e.replace(/\s|•/g,"")}const E=(e,t,n,r,s,o,l,i,u)=>{const{validateInputNumber:c}=m(o,l,i,u),[d,p]=(0,a.useState)("");let v="wc-block-components-text-input pagarme-credit-card-number-container";const[f,h]=(0,a.useState)(!1);(f||e.length)&&(v+=" is-active"),l.hasOwnProperty("inputNumber")&&(v+=" has-error");const g=()=>{r(o,""),p("")};return{setIsActive:h,cssClasses:v,brandImageSrc:d,inputChangeHandler:e=>{n(o,e.target.value)},inputBlurHandler:n=>{c(n.target.value),(async()=>{const n=b(e);if(16!==n.length)return void g();s(!0);const a=n.substring(0,6),l=`https://api.pagar.me/bin/v1/${a}`;try{const e=await fetch(l),n=await e.json();let i=n.brand;if(e.ok&&void 0!==n.brandName||(i=(e=>{let n="",r=null;for(const[a,s]of Object.entries(t))for(const t of s.prefixes){const s=t.toString();0===e.indexOf(s)&&n.length<s.length&&(n=s,r=a)}return r})(a)),null===i)return g(),void s(!1);if(n.brandImage)return p(n.brandImage),s(!1),void r(o,i);p(`https://cdn.mundipagg.com/assets/images/logos/brands/png/${i}.png`),s(!1),r(o,i)}catch(e){g(),s(!1)}})(),h(!1)}}},C=({id:t,label:n,inputValue:r,setInputValue:a,brand:s,setBrand:o,brands:l,setIsLoading:i,cardIndex:u,errors:c,setErrors:d,fieldErrors:p})=>{const{setIsActive:m,cssClasses:v,brandImageSrc:f,inputChangeHandler:h,inputBlurHandler:b}=E(r,l,a,o,i,u,c,d,p);return(0,e.createElement)("div",{className:v},(0,e.createElement)("label",{htmlFor:t},n),(0,e.createElement)(g(),{className:"pagarme-card-form-card-number",type:"text",id:t,mask:"9999 9999 9999 9999",maskChar:"•",onFocus:()=>m(!0),onChange:h,value:r,onBlur:b}),f&&(0,e.createElement)("img",{src:f,alt:s}),c.inputNumber&&(0,e.createElement)("div",{className:"wc-block-components-validation-error",role:"alert"},(0,e.createElement)("p",null,c.inputNumber)))};C.propTypes={id:r().string.isRequired,label:r().string.isRequired,inputValue:r().string.isRequired,setInputValue:r().func.isRequired,brand:r().string.isRequired,setBrand:r().func.isRequired,brands:r().object.isRequired,setIsLoading:r().func.isRequired,cardIndex:r().number.isRequired,errors:r().object.isRequired,setErrors:r().func.isRequired,fieldErrors:r().object.isRequired};const I=C,k=({id:t,label:n,inputValue:r,setInputValue:s,cardIndex:o,validate:l,validateIndex:i,mask:u,maskChar:c=null,errors:d})=>{const{setIsActive:p,cssClasses:m,inputChangeHandler:v,inputBlurHandler:f}=((e,t,n,r,s,o)=>{let l="wc-block-components-text-input";const[i,u]=(0,a.useState)(!1);return(i||e.length)&&(l+=" is-active"),o.hasOwnProperty(s)&&(l+=" has-error"),{setIsActive:u,cssClasses:l,inputChangeHandler:e=>{t(n,e.target.value)},inputBlurHandler:e=>{r(e.target.value),u(!1)}}})(r,s,o,l,i,d);return(0,e.createElement)("div",{className:m},(0,e.createElement)("label",{htmlFor:t},n),(0,e.createElement)(g(),{type:"text",id:t,mask:u,maskChar:c,onChange:v,value:r,onFocus:()=>p(!0),onBlur:f}))};k.propTypes={id:r().string.isRequired,label:r().string.isRequired,inputValue:r().string.isRequired,setInputValue:r().func.isRequired,cardIndex:r().number.isRequired,mask:r().string.isRequired,maskChar:r().string,validate:r().func.isRequired,validateIndex:r().string.isRequired,errors:r().object.isRequired};const w=k,y=({id:t,label:n,cardIndex:r,inputValue:a,setInputValue:s,errors:o,setErrors:l,fieldErrors:i})=>{const{validateInputExpiry:u}=m(r,o,l,i);return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(w,{id:t,label:n,mask:"99/99",maskChar:"_",inputValue:a,setInputValue:s,cardIndex:r,validate:u,validateIndex:"inputExpiry",errors:o}),o.inputExpiry&&(0,e.createElement)("div",{className:"wc-block-components-validation-error",role:"alert"},(0,e.createElement)("p",null,o.inputExpiry)))};y.propTypes={id:r().string.isRequired,label:r().string.isRequired,cardIndex:r().number.isRequired,inputValue:r().string.isRequired,setInputValue:r().func.isRequired,errors:r().object.isRequired,setErrors:r().func.isRequired,fieldErrors:r().object.isRequired};const R=y,x=({id:t,label:n,cardIndex:r,inputValue:a,setInputValue:s,errors:o,setErrors:l,fieldErrors:i})=>{const{validateInputCvv:u}=m(r,o,l,i);return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(w,{id:t,label:n,mask:"9999",inputValue:a,setInputValue:s,cardIndex:r,validate:u,validateIndex:"inputCvv",errors:o}),o.inputCvv&&(0,e.createElement)("div",{className:"wc-block-components-validation-error",role:"alert"},(0,e.createElement)("p",null,o.inputCvv)))};x.propTypes={id:r().string.isRequired,label:r().string.isRequired,cardIndex:r().number.isRequired,inputValue:r().string.isRequired,setInputValue:r().func.isRequired,errors:r().object.isRequired,setErrors:r().func.isRequired,fieldErrors:r().object.isRequired};const S=x,{ComboboxControl:O}=wp.components,N=({cards:t,label:n,cardIndex:r,selectedCard:a,setSelectCard:s,setBrand:o})=>{const{filterHandler:l,cardChangeHandler:i}=((e,t,n,r)=>({filterHandler:t=>{e.filter((e=>e.label.toLowerCase().startsWith(t.toLowerCase())))},cardChangeHandler:a=>{if(n(t,a),!e)return;const s=e.find((e=>e.value===a));r(t,s?s.brand:"")}}))(t,r,s,o);return(0,e.createElement)("div",{className:"wc-block-components-select-input pagarme-installments-combobox"},(0,e.createElement)("div",{className:"wc-block-components-combobox is-active"},(0,e.createElement)(O,{className:"wc-block-components-combobox-control",label:n,onChange:i,value:a,options:t,onFilterValueChange:l,allowReset:!1,autoComplete:"off"})))};N.propTypes={cards:r().array.isRequired,label:r().string.isRequired,cardIndex:r().number.isRequired,selectedCard:r().string.isRequired,setSelectCard:r().func.isRequired,setBrand:r().func.isRequired};const V=N,q=window.wp.data,T={holderName:"",number:"",expirationDate:"",installment:1,brand:"",cvv:"",saveCard:!1,walletId:"",errors:{}},P={cards:{1:{...T},2:{...T}}},D=(0,q.createReduxStore)("pagarme-cards",{reducer(e=P,t){switch(t.type){case"SET_PROPERTY_VALUE":return 0===t.propertyName?.length?e:{...e,cards:{...e.cards,[t.cardIndex]:{...e.cards[t.cardIndex],[t.propertyName]:t.value}}};case"RESET":return P}return e},actions:{setHolderName:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"holderName"}),setNumber:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"number"}),setExpirationDate:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"expirationDate"}),setInstallment:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"installment"}),setBrand:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"brand"}),setCvv:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"cvv"}),setSaveCard:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"saveCard"}),setWalletId:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"walletId"}),setErrors:(e,t)=>({type:"SET_PROPERTY_VALUE",cardIndex:e,value:t,propertyName:"errors"}),reset:()=>({type:"RESET"})},selectors:{getHolderName:(e,t)=>e.cards[t].holderName,getNumber:(e,t)=>e.cards[t].number,getExpirationDate:(e,t)=>e.cards[t].expirationDate,getInstallment:(e,t)=>e.cards[t].installment,getBrand:(e,t)=>e.cards[t].brand,getCvv:(e,t)=>e.cards[t].cvv,getSaveCard:(e,t)=>e.cards[t].saveCard,getWalletId:(e,t)=>e.cards[t].walletId,getCards:e=>e.cards,getErrors:(e,t)=>e.cards[t].errors}});(0,q.register)(D);const L=D,{CheckboxControl:M}=window.wc.blocksComponents,_=({billing:t,components:n,backendConfig:r,cardIndex:s,eventRegistration:o})=>{const{LoadingMask:l}=n,{holderNameLabel:i,numberLabel:u,expiryLabel:c,cvvLabel:p,installmentsLabel:v,saveCardLabel:h,walletLabel:g}=r.fieldsLabels,{isLoading:b,setIsLoading:E,setHolderName:C,setNumber:k,setExpirationDate:w,setInstallment:y,setBrand:x,setCvv:O,setWalletId:N,setErrors:T,saveCardChangeHandler:P,formatFieldId:D,holderName:_,number:j,expirationDate:H,selectedInstallment:B,brand:F,cvv:A,saveCard:U,walletId:Y,errors:$}=((e,t,n)=>{const[r,s]=(0,a.useState)(!1),{setHolderName:o,setNumber:l,setExpirationDate:i,setInstallment:u,setBrand:c,setCvv:d,setSaveCard:p,setWalletId:v,setErrors:f}=(0,q.useDispatch)(L),h=(0,q.useSelect)((t=>t(L).getHolderName(e)),[e]),g=(0,q.useSelect)((t=>t(L).getNumber(e)),[e]),b=(0,q.useSelect)((t=>t(L).getExpirationDate(e)),[e]),E=(0,q.useSelect)((t=>t(L).getInstallment(e)),[e]),C=(0,q.useSelect)((t=>t(L).getBrand(e)),[e]),I=(0,q.useSelect)((t=>t(L).getCvv(e)),[e]),k=(0,q.useSelect)((t=>t(L).getSaveCard(e)),[e]),w=(0,q.useSelect)((t=>t(L).getWalletId(e)),[e]),y=(0,q.useSelect)((t=>t(L).getErrors(e)),[e]),{validateAllFields:R}=m(e,y,f,n.fieldErrors),{onCheckoutValidation:x}=t;return(0,a.useEffect)((()=>x((()=>(w.length>0||R(h,g,b,I),!0)))),[x,h,g,b,I,n,w]),{isLoading:r,setIsLoading:s,setHolderName:o,setNumber:l,setExpirationDate:i,setInstallment:u,setBrand:c,setCvv:d,setWalletId:v,setErrors:f,saveCardChangeHandler:t=>{p(e,t)},formatFieldId:t=>`pagarme_credit_card_${e}_${t}`,holderName:h,number:g,expirationDate:b,selectedInstallment:E,brand:C,cvv:I,saveCard:k,walletId:w,errors:y}})(s,o,r);return(0,e.createElement)(l,{isLoading:b},(0,e.createElement)("div",{className:"wc-block-components-form"},r?.walletEnabled&&r?.cards?.length>0&&(0,e.createElement)(V,{label:g,selectedCard:Y,cards:r.cards,cardIndex:s,setSelectCard:N,setBrand:x}),0===Y.length&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(f,{id:D("holder_name"),label:i,inputValue:_,setInputValue:C,cardIndex:s,errors:$,setErrors:T,fieldErrors:r?.fieldErrors}),(0,e.createElement)(I,{id:D("number"),label:u,inputValue:j,setInputValue:k,brand:F,setBrand:x,brands:r?.brands,setIsLoading:E,cardIndex:s,errors:$,setErrors:T,fieldErrors:r?.fieldErrors}),(0,e.createElement)(R,{id:D("expiry"),label:c,inputValue:H,setInputValue:w,cardIndex:s,errors:$,setErrors:T,fieldErrors:r?.fieldErrors}),(0,e.createElement)(S,{id:D("cvv"),label:p,inputValue:A,setInputValue:O,cardIndex:s,errors:$,setErrors:T,fieldErrors:r?.fieldErrors})),(0,e.createElement)(d,{label:v,installments:r?.installments,installmentsType:r?.installmentsType,selectedInstallment:B,setSelectedInstallment:y,brand:F,cartTotal:t.cartTotal.value,setIsLoading:E,cardIndex:s}),0===Y.length&&r?.walletEnabled&&(0,e.createElement)(M,{label:h,checked:U,onChange:P})))};_.propType={billing:r().object.isRequired,components:r().object.isRequired,backendConfig:r().object.isRequired,cardIndex:r().number.isRequired,eventRegistration:r().object.isRequired};const j=_;class H extends Error{constructor(e){super(e),this.name=this.constructor.name}}const B=(e,t,n)=>{const r=`${e.replace("request.","").replace("card.","")}: ${t}`;return n.hasOwnProperty(r)?n[r]:""};async function F(e,t,n,r,a,s){const[o,l]=p(n),i={card:{holder_name:t,number:b(e),exp_month:o,exp_year:l,cvv:r}};try{const e=`https://api.pagar.me/core/v5/tokens?appId=${a}`,t=await fetch(e,{method:"POST",body:JSON.stringify(i)});if(!t.ok){const e=await t.text();if(0===e.length)return{errorMessage:s.serviceUnavailable};const n=((e,t)=>{let n="";for(const r in e.errors)for(const a of e.errors[r]||[]){const e=B(r,a,t);0!==e.length&&(n+=`${e}<br/>`)}return n})(JSON.parse(e),s);return{errorMessage:n}}return{token:(await t.json()).id}}catch(e){return{errorMessage:s.serviceUnavailable}}}const A=(e,t,n)=>{const{reset:r}=(0,q.useDispatch)(L),{onPaymentSetup:s}=n,o=(0,q.useSelect)((e=>e(L).getCards()));(0,a.useEffect)((()=>{r()}),[]),(0,a.useEffect)((()=>s((async()=>{try{let n=!1;if("object"==typeof o&&(n=Object.values(o).some((e=>Object.keys(e.errors).length>0))),n)return{type:t.responseTypes.ERROR,message:e.errorMessages.creditCardFormHasErrors};const r=await(async(e,t,n)=>{const r=[];for(let a=1;a<t+1;++a){const{holderName:t,number:s,expirationDate:o,cvv:l,brand:i,installment:u,saveCard:c,walletId:d}=e[a];if(d.length>0){r[a]={"wallet-id":d,brand:i,installment:u};continue}const p=await F(s,t,o,l,n.appId,n.errorMessages);if(p.errorMessage)throw new H(p.errorMessage);r[a]={token:p.token,brand:i,installment:u},c&&(r[a]["save-card"]=c)}return r})(o,1,e);return{type:t.responseTypes.SUCCESS,meta:{paymentMethodData:{pagarme:JSON.stringify({[e.key]:{cards:{...r}}}),payment_method:e.key}}}}catch(n){let r=e.errorMessages.serviceUnavailable;return n instanceof H&&(r=n.message),{type:t.responseTypes.ERROR,message:r}}}))),[s,o,e])},{registerPaymentMethod:U}=window.wc.wcBlocksRegistry,Y=wc.wcSettings.getSetting("woo-pagarme-payments-credit_card_data"),$=t=>{const{emitResponse:n,eventRegistration:r}=t;return A(Y,n,r),(0,e.createElement)(j,{...t,backendConfig:Y,cardIndex:1})},W=({components:t})=>{const{PaymentMethodLabel:n}=t;return(0,e.createElement)(n,{text:Y.label})};$.propTypes={emitResponse:r().object,eventRegistration:r().object},W.propTypes={components:r().object},U({name:Y.name,label:(0,e.createElement)(W,null),content:(0,e.createElement)($,null),edit:(0,e.createElement)($,null),canMakePayment:()=>!0,ariaLabel:Y.ariaLabel})})()})();